name: ðŸš€ FIX STRING RESOURCES
on: workflow_dispatch
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Java 17 for Android SDK
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
      
      - name: Install Android SDK
        run: |
          $ANDROID_HOME/cmdline-tools/latest/bin/sdkmanager "platforms;android-33" "build-tools;33.0.0"
      
      - name: Switch to Java 11 for Gradle
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'
      
      - name: Fix string resources
        run: |
          # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ strings.xml Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Ð¾ÑˆÐ¸Ð±Ð¾Ðº
          mkdir -p TMessagesProj/src/main/res/values
          cat > TMessagesProj/src/main/res/values/strings.xml << 'EOF'
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name">KotuktoperGram</string>
    <string name="ActionGroupCallEnded">Call ended</string>
    <string name="ActionGroupCallJustStarted">Call started</string>
    <string name="CancelForward">Cancel</string>
    <string name="CancelForwardMessage">Cancel forward</string>
    <string name="ClearRecentEmoji">Clear recent</string>
</resources>
EOF
          echo "âœ… Created basic strings.xml"
      
      - name: Build
        run: |
          chmod +x gradlew
          ./gradlew clean assembleDebug --no-daemon --stacktrace
      
      - uses: actions/upload-artifact@v4
        with:
          name: KotuktoperGram
          path: "**/build/outputs/apk/**/*.apk"

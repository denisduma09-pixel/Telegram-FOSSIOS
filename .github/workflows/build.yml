name: üöÄ FIX STRING RESOURCES
on: workflow_dispatch
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Java 17 for Android SDK
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
      
      - name: Install Android SDK
        run: |
          $ANDROID_HOME/cmdline-tools/latest/bin/sdkmanager "platforms;android-33" "build-tools;33.0.0"
      
      - name: Switch to Java 11 for Gradle
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'
      
      - name: Fix string resources
        run: |
          # –°–æ–∑–¥–∞–µ–º strings.xml –ø—Ä–æ—Å—Ç—ã–º —Å–ø–æ—Å–æ–±–æ–º
          mkdir -p TMessagesProj/src/main/res/values
          echo '<?xml version="1.0" encoding="utf-8"?>' > TMessagesProj/src/main/res/values/strings.xml
          echo '<resources>' >> TMessagesProj/src/main/res/values/strings.xml
          echo '    <string name="app_name">KotuktoperGram</string>' >> TMessagesProj/src/main/res/values/strings.xml
          echo '    <string name="ActionGroupCallEnded">Call ended</string>' >> TMessagesProj/src/main/res/values/strings.xml
          echo '    <string name="ActionGroupCallJustStarted">Call started</string>' >> TMessagesProj/src/main/res/values/strings.xml
          echo '    <string name="CancelForward">Cancel</string>' >> TMessagesProj/src/main/res/values/strings.xml
          echo '    <string name="CancelForwardMessage">Cancel forward</string>' >> TMessagesProj/src/main/res/values/strings.xml
          echo '    <string name="ClearRecentEmoji">Clear recent</string>' >> TMessagesProj/src/main/res/values/strings.xml
          echo '</resources>' >> TMessagesProj/src/main/res/values/strings.xml
          echo "‚úÖ Created basic strings.xml"
      
      - name: Build
        run: |
          chmod +x gradlew
          ./gradlew clean assembleDebug --no-daemon --stacktrace
      
      - uses: actions/upload-artifact@v4
        with:
          name: KotuktoperGram
          path: "**/build/outputs/apk/**/*.apk"
